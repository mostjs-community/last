{"version":3,"file":null,"sources":["../src/index.ts"],"sourcesContent":["import { Disposable, Stream, Sink, Scheduler, Time } from '@most/types'\n\ninterface Held<T> {\n  val: T;\n}\n\nconst last = <T>(stream: Stream<T>) =>\n  new Last(stream)\n\nclass Last<T> implements Stream<T> {\n  constructor (private source: Stream<T>) {}\n\n  run (sink: Sink<T>, scheduler: Scheduler) {\n    return this.source.run(new LastSink(sink), scheduler)\n  }\n}\n\nclass LastSink<T> implements Sink<T> {\n  private held?: Held<T>\n  constructor (private sink: Sink<T>) {}\n\n  event (_: Time, val: T) {\n    this.held = { val }\n  }\n\n  error (t: Time, e: Error) {\n    this.sink.error(t, e)\n  }\n\n  end (t: Time) {\n    if (this.held) {\n      this.sink.event(t, this.held.val)\n    }\n    this.sink.end(t)\n  }\n}\n\nexport { last, Last }"],"names":[],"mappings":";;;;;;AAMA,IAAM,IAAI,GAAG,UAAI,MAAiB;IAChC,OAAA,IAAI,IAAI,CAAC,MAAM,CAAC;CAAA,CAAA;AAElB;IACE,cAAqB,MAAiB;QAAjB,WAAM,GAAN,MAAM,CAAW;KAAI;IAE1C,kBAAG,GAAH,UAAK,IAAa,EAAE,SAAoB;QACtC,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,SAAS,CAAC,CAAA;KACtD;IACH,WAAC;CAAA,IAAA;AAED;IAEE,kBAAqB,IAAa;QAAb,SAAI,GAAJ,IAAI,CAAS;KAAI;IAEtC,wBAAK,GAAL,UAAO,CAAO,EAAE,GAAM;QACpB,IAAI,CAAC,IAAI,GAAG,EAAE,GAAG,KAAA,EAAE,CAAA;KACpB;IAED,wBAAK,GAAL,UAAO,CAAO,EAAE,CAAQ;QACtB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;KACtB;IAED,sBAAG,GAAH,UAAK,CAAO;QACV,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;SAClC;QACD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;KACjB;IACH,eAAC;CAAA,IAAA,AAED,AAAqB;;;;;;;"}