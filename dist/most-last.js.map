{"version":3,"file":null,"sources":["../src/index.ts"],"sourcesContent":["import { Stream, Sink, Scheduler, Time } from '@most/types'\n\nexport const last = <T>(stream: Stream<T>) =>\n  new Last(stream)\n\nclass Last<T> {\n  constructor (private source: Stream<T>) {}\n\n  run (sink: Sink<T>, scheduler: Scheduler) {\n    return this.source.run(new LastSink(sink), scheduler)\n  }\n}\n\nclass LastSink<V> {\n  private has: boolean = false\n  private value: V = void 0\n\n  constructor (private sink: Sink<V>) {}\n\n  event (t: Time, x: V) {\n    this.has = true\n    this.value = x\n  }\n\n  error (t: Time, e: Error) {\n    this.sink.error(t, e)\n  }\n\n  end (t: Time) {\n    if (this.has) {\n      this.sink.event(t, this.value)\n    }\n    this.sink.end(t)\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEO,IAAM,IAAI,GAAG,UAAI,MAAiB;IACvC,OAAA,IAAI,IAAI,CAAC,MAAM,CAAC;CAAA,CAAA;AAElB;IACE,cAAqB,MAAiB;QAAjB,WAAM,GAAN,MAAM,CAAW;KAAI;IAE1C,kBAAG,GAAH,UAAK,IAAa,EAAE,SAAoB;QACtC,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,SAAS,CAAC,CAAA;KACtD;IACH,WAAC;CAAA,IAAA;AAED;IAIE,kBAAqB,IAAa;QAAb,SAAI,GAAJ,IAAI,CAAS;QAH1B,QAAG,GAAY,KAAK,CAAA;QACpB,UAAK,GAAM,KAAK,CAAC,CAAA;KAEa;IAEtC,wBAAK,GAAL,UAAO,CAAO,EAAE,CAAI;QAClB,IAAI,CAAC,GAAG,GAAG,IAAI,CAAA;QACf,IAAI,CAAC,KAAK,GAAG,CAAC,CAAA;KACf;IAED,wBAAK,GAAL,UAAO,CAAO,EAAE,CAAQ;QACtB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;KACtB;IAED,sBAAG,GAAH,UAAK,CAAO;QACV,IAAI,IAAI,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;SAC/B;QACD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;KACjB;IACH,eAAC;CAAA,IAAA;;;;;;"}