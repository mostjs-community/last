{"version":3,"file":"most-last.js","sources":["../src/index.ts"],"sourcesContent":["import { Disposable, Scheduler, Sink, Stream, Time } from '@most/types'\n\ninterface Held<T> {\n  val: T\n}\n\nconst last = <T>(stream: Stream<T>) =>\n  new Last(stream)\n\nclass Last<T> implements Stream<T> {\n  constructor (\n    private source: Stream<T>\n  ) {}\n\n  run (sink: Sink<T>, scheduler: Scheduler): Disposable {\n    return this.source.run(new LastSink(sink), scheduler)\n  }\n}\n\nclass LastSink<T> implements Sink<T> {\n  private held?: Held<T>\n\n  constructor (\n    private sink: Sink<T>\n  ) {}\n\n  event (_: Time, val: T) {\n    this.held = { val }\n  }\n\n  error (t: Time, e: Error) {\n    this.sink.error(t, e)\n  }\n\n  end (t: Time) {\n    if (this.held) {\n      this.sink.event(t, this.held.val)\n    }\n    this.sink.end(t)\n  }\n}\n\nexport { last, Last }\n"],"names":[],"mappings":";;;;;;MAMM,IAAI,GAAG,UAAI,MAAiB;MAChC,OAAA,IAAI,IAAI,CAAC,MAAM,CAAC;EAAhB,CAAgB,CAAA;AAElB;MACE,cACU,MAAiB;UAAjB,WAAM,GAAN,MAAM,CAAW;OACvB;MAEJ,kBAAG,GAAH,UAAK,IAAa,EAAE,SAAoB;UACtC,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,IAAI,CAAC,EAAE,SAAS,CAAC,CAAA;OACtD;MACH,WAAC;EAAD,CAAC,IAAA;EAED;MAGE,kBACU,IAAa;UAAb,SAAI,GAAJ,IAAI,CAAS;OACnB;MAEJ,wBAAK,GAAL,UAAO,CAAO,EAAE,GAAM;UACpB,IAAI,CAAC,IAAI,GAAG,EAAE,GAAG,KAAA,EAAE,CAAA;OACpB;MAED,wBAAK,GAAL,UAAO,CAAO,EAAE,CAAQ;UACtB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAA;OACtB;MAED,sBAAG,GAAH,UAAK,CAAO;UACV,IAAI,IAAI,CAAC,IAAI,EAAE;cACb,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;WAClC;UACD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;OACjB;MACH,eAAC;EAAD,CAAC,IAAA;;;;;;;;;;;;;"}